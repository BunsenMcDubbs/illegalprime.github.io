<!DOCTYPE html>
<html>
<head>
	<link href="http://gmpg.org/xfn/11" rel="profile">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<link rel="canonical" href="https://illegalprime.github.io//blog/bitshifts-n-safetybelts" />
	<meta name="description" content="Image: Savannah GA, alligators hiding in the marsh." />
	<meta property="og:description" content="Image: Savannah GA, alligators hiding in the marsh." />
	<meta itemprop="image" content="https://illegalprime.github.io//media/2014-08-04-stickshifts-n-safetybelts/cover.jpg" />
	<meta property="og:image" content="https://illegalprime.github.io//media/2014-08-04-stickshifts-n-safetybelts/cover.jpg" />
	<meta property="og:title" content="Bitshifts & Safetybelts" />
	<meta property="og:type" content="article" />
	<meta property="og:url" content="https://illegalprime.github.io//blog/bitshifts-n-safetybelts" />
	<meta property="og:site_name" content="Michael Eden" />
	<title>Bitshifts & Safetybelts &middot; Michael Eden</title>
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="HandheldFriendly" content="True" />
	<meta name="MobileOptimized" content="320" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="fb:app_id" content="1482009368710102"/>
	<link rel="stylesheet" type="text/css" media="only screen and (min-width: 1001px)" href="/assets/css/desktop.css" />
	<link rel="stylesheet" type="text/css" media="only screen and (max-width: 1000px)" href="/assets/css/mobile.css" />
	<link href="/assets/css/genericons.css" type="text/css" rel="stylesheet" />
	<link href="/assets/css/syntax.css" type="text/css" rel="stylesheet" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
	<link rel="apple-touch-icon" href="https://illegalprime.github.io//assets/images/icon.png">
	<link rel="shortcut icon" href="https://illegalprime.github.io//assets/images/favicon.ico">
	<link rel="alternate" type="application/rss+xml" title="RSS" href="https://illegalprime.github.io//atom.xml">
	<script type="text/javascript" src="/assets/js/additions.js"></script>
</head>


<body>
	<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=1482009368710102&version=v2.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div id='following_menu' style="background-image: url(/media/2014-08-04-stickshifts-n-safetybelts/cover.jpg); background-position: 0%  90% ;">
	<div id="following_overlay">
		<div id="following_social_container">
			
<a href="mailto:themichaeleden@gmail.com" target="" title="Email me"><span class="genericon genericon-mail"></span></a>

<a href="https://github.com/illegalprime" target=" _blank " title="Fork me on GitHub"><span class="genericon genericon-github"></span></a>

<a href="https://plus.google.com/+MichaelEdenIsGreat" target=" _blank " title="Add me on Google+"><span class="genericon genericon-googleplus-alt"></span></a>

<a href="http://illegalprime.github.io/atom.xml" target=" _blank " title="Subscribe to my Feed (Atom)"><span class="genericon genericon-feed"></span></a>

		</div>
		<div id="following_menu_container">
			<div class="menu_bar">
	
		<a  class='menu_normal' onmouseover="this.className='menu_highlighted'" onmouseout="this.className='menu_normal'"  href="/">Home</a>
	
		<a  class='menu_normal' onmouseover="this.className='menu_highlighted'" onmouseout="this.className='menu_normal'"  href="/archive">Archive</a>
	
		<a  class='menu_normal' onmouseover="this.className='menu_highlighted'" onmouseout="this.className='menu_normal'"  href="/categories">By Category</a>
	
		<a  class='menu_normal' onmouseover="this.className='menu_highlighted'" onmouseout="this.className='menu_normal'"  href="/contact">Contact Me</a>
	
		<a  class='menu_normal' onmouseover="this.className='menu_highlighted'" onmouseout="this.className='menu_normal'"  href="/about">About</a>
	
</div>

		</div>
	</div>
</div>
<header class="clean" style="background-image: url(/media/2014-08-04-stickshifts-n-safetybelts/cover.jpg);height: 100%;">
	
	<!--
<label class="menu" for="_1">
	<span class="genericon genericon-menu"></span>
</label>
<input id="_1" type="checkbox">
<div class="menu-content">
	<div class="menu" style="background-color: #777; z-index: 2;"></div>
	
	<a href="/">Home</a><br>
	
	<a href="/archive">Archive</a><br>
	
	<a href="/categories">By Category</a><br>
	
	<a href="/contact">Contact Me</a><br>
	
	<a href="/about">About</a><br>
	
</div>-->

<!--<div class="menu-content">
	
	<a href="/">Home</a><br>
	
	<a href="/archive">Archive</a><br>
	
	<a href="/categories">By Category</a><br>
	
	<a href="/contact">Contact Me</a><br>
	
	<a href="/about">About</a><br>
	
</div>-->

<div class="social-links">
	
<a href="mailto:themichaeleden@gmail.com" target="" title="Email me"><span class="genericon genericon-mail"></span></a>

<a href="https://github.com/illegalprime" target=" _blank " title="Fork me on GitHub"><span class="genericon genericon-github"></span></a>

<a href="https://plus.google.com/+MichaelEdenIsGreat" target=" _blank " title="Add me on Google+"><span class="genericon genericon-googleplus-alt"></span></a>

<a href="http://illegalprime.github.io/atom.xml" target=" _blank " title="Subscribe to my Feed (Atom)"><span class="genericon genericon-feed"></span></a>

</div>
	<div id='top_menu'>
	<div class="menu_bar">
	
		<a  class='menu_normal' onmouseover="this.className='menu_highlighted'" onmouseout="this.className='menu_normal'"  href="/">Home</a>
	
		<a  class='menu_normal' onmouseover="this.className='menu_highlighted'" onmouseout="this.className='menu_normal'"  href="/archive">Archive</a>
	
		<a  class='menu_normal' onmouseover="this.className='menu_highlighted'" onmouseout="this.className='menu_normal'"  href="/categories">By Category</a>
	
		<a  class='menu_normal' onmouseover="this.className='menu_highlighted'" onmouseout="this.className='menu_normal'"  href="/contact">Contact Me</a>
	
		<a  class='menu_normal' onmouseover="this.className='menu_highlighted'" onmouseout="this.className='menu_normal'"  href="/about">About</a>
	
</div>

</div>
	<div id="post-info">
		<h1>Bitshifts & Safetybelts</h1>
		
			<h2>Image: Savannah GA, alligators hiding in the marsh.</h2>
		
		<a class="site-title" href="https://illegalprime.github.io/"><img src="/assets/images/icon.png" class="site-icon-small">Michael Eden</a>
	</div>
	<div id="nav-icon">
		<a class="scroll" data-speed="1000" href="#article"><span class="genericon genericon-expand"></span></a>
	</div>
</header>
<div id="article" class="" >
	<h1>The Steganographic Way</h1>

<p>Look at this picture of Andy, do you see a hidden message?</p>

<div><img src="/media/2014-08-04-stickshifts-n-safetybelts/andy-encoded.png" alt="The text 'Hello World!' is encoded into this image." />
<blockquote style="border-left: 10px solid #D5D5D5;">The text 'Hello World!' is encoded into this image.</blockquote></div>

<p>&#39;Hello World!&#39; is able to live inside that image using one common method of Steganography: &quot;the art or practice of concealing a message, image, or file within another message, image, or file&quot;<a href="http://en.wikipedia.org/wiki/Steganography"><sup>[1]</sup></a>.</p>

<p>To visualize this hiding we first transform the message into binary (using <a href="http://en.wikipedia.org/wiki/Unicode">Unicode</a>):</p>
<div class="highlight"><pre><code class="language-C++" data-lang="C++">        <span class="n">H</span>                       <span class="n">e</span>
<span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0100</span> <span class="mi">1000</span>     <span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0110</span> <span class="mo">0101</span> 
        <span class="n">l</span>                       <span class="n">l</span>
<span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0110</span> <span class="mi">1100</span>     <span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0110</span> <span class="mi">1100</span> 
        <span class="n">o</span>                       <span class="n">space</span> 
<span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0110</span> <span class="mi">1111</span>     <span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0010</span> <span class="mo">0000</span> 
        <span class="n">W</span>                       <span class="n">o</span>                       
<span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0101</span> <span class="mo">0111</span>     <span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0110</span> <span class="mi">1111</span> 
        <span class="n">r</span>                       <span class="n">l</span>
<span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0111</span> <span class="mo">0010</span>     <span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0110</span> <span class="mi">1100</span> 
        <span class="n">d</span>                       <span class="o">!</span>
<span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0110</span> <span class="mo">0100</span>     <span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0010</span> <span class="mo">0001</span>
</code></pre></div>
<p>The idea here is to take all the bits and place each of them on one pixel of the image. Since there are 192 bits (count them!) we will need a image file that is <em>at least</em> 192 pixels. Good thing our picture of Andy is 496 x 274 = 135904 pixels! This gives you an idea of exactly how much you can fit into Andy.</p>

<p>So where in the pixel do we put this bit?? Well each pixel in an image must be a fixed number of bits long (so computers can read the image correctly), so we cannot just squeeze this bit in between the bits of the pixel. No, the only other option is to </p>

<ol>
<li>Pick a bit in the pixel</li>
<li>Remove this bit</li>
<li>Replace it with a bit from the message</li>
<li>Repeat until all message bits are in pixels</li>
</ol>

<p>To change the color of the pixel the least (to make our efforts the more inconspicuous) we are going to peel of the LSB (least significant bit) from the image. Here&#39;s a visual:</p>

<table>
<th>
    <td>
        Before
    </td>
    <td>
        After
    </td>
</th>
<tr>
    <td>
        Replacing the most significant bit (left most)
    </td>
    <td style="background-color:#0000FF;"></td>
    <td style="background-color:#8000FF;"></td>
</tr>
<tr>
    <td>Binary:</td>
    <td>
        000000000000000011111111
    </td>
    <td>
        100000000000000011111111
    </td>
</tr>
<tr>
    <td>&nbsp;</td>
</tr>
<tr>
    <td>
        Replacing the least significant bit (right most)
    </td>
    <td style="background-color:#0000FF;"></td>
    <td style="background-color:#0000FE;"></td>
</tr>
<tr>
    <td>Binary:</td>
    <td>
        000000000000000011111111
    </td>
    <td>
        000000000000000011111110
    </td>
</tr>
</table>

<p>Of course there is a 50% chance that the bit we remove and the bit we replace will coincidentally be the same. In this case literally nothing is changed for that pixel.</p>

<h1>The Code</h1>

<p>I&#39;ve, after learning about this method, written a program to automate the process. In it though I have reserved the first 32 pixels to tell the program how long the message is so it will know how much of the image to decode.</p>

<p>Written in C++ &amp; Qt, the code starts by creating a copy of the image so the copy can be changed and encoded. It then initializes x and y, which represent the coordinates of the image: (0, 0) means top left. Finally it gets the message length to encode into the first 32 pixels of the image.</p>
<div class="highlight"><pre><code class="language-C++" data-lang="C++"><span class="n">QImage</span><span class="o">*</span> <span class="n">Cipher</span><span class="o">::</span><span class="n">encodeImage</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">QImage</span><span class="o">*</span> <span class="n">encodedImage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QImage</span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">image</span><span class="p">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">image</span><span class="p">.</span><span class="n">height</span><span class="p">()));</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">message</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">message</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="o">||</span> <span class="n">bitsPerPixel</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">encodedImage</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div>
<p>then we have this ugly thing:</p>
<div class="highlight"><pre><code class="language-C++" data-lang="C++"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">mask</span> <span class="o">=</span> <span class="mh">0x0001</span><span class="p">;</span> <span class="n">mask</span> <span class="o">!=</span> <span class="mh">0x0000</span><span class="p">;</span> <span class="n">mask</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</code></pre></div>
<p>This loop initializes <code>mask</code> to equal 1. Then each pass of the loop shifts all the bits in mask to the left then saves that value back to mask. A quick reminder on what left bit shift is:</p>
<div class="highlight"><pre><code class="language-C++" data-lang="C++"><span class="kt">int</span> <span class="n">mask</span><span class="p">;</span>
<span class="n">mask</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>   <span class="c1">//      mask = 0 ...23 0&#39;s... 0000 0001</span>

            <span class="c1">// Shift all bits one to the left, then save it in &#39;mask&#39;</span>
<span class="n">mask</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//      mask = 0 ...23 0&#39;s... 0000 0010</span>

            <span class="c1">// Shift again</span>
<span class="n">mask</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//      mask = 0 ...23 0&#39;s... 0000 0100</span>

<span class="c1">// and so on. until that lone &#39;1&#39; is shifted all</span>
<span class="c1">// the way to the end (left), after that it is simply</span>
<span class="c1">// shifted out of existence. Then only 0&#39;s are left.</span>

<span class="c1">// When this happens </span>

<span class="n">mask</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span>  <span class="c1">// is true and the loop exits</span>
</code></pre></div>
<p>This loop generates a variable (<code>mask</code>) that will only contain &#39;0&#39;s except for one &#39;1&#39;, this &#39;1&#39; will also be in every location on the variable only once. This is great news.</p>

<p>Basically the location of the &#39;1&#39; in <code>mask</code> decides which bit of <code>header</code> to use. </p>

<div class="message">This first loop encodes the <code>header</code> variable into the image which is a lot like encoding the actual message, this is done in the second loop. <code>header</code> just contains the length of the message, which the program needs to know for later decoding. </div>

<p>This can be done by using a bitwise AND. Bitwise AND (<code>&amp;</code>) takes two bits and outputs one. If both these bits are &#39;1&#39; it will output &#39;1&#39;, otherwise the output will be &#39;0&#39;. Because <code>mask</code> moves its &#39;1&#39; along to the left, we can get each bit of <code>header</code> from doing <code>header &amp; mask</code> in this loop:</p>
<div class="highlight"><pre><code class="language-C++" data-lang="C++"><span class="n">mask</span>           <span class="mo">000000000001</span>
<span class="n">header</span>       <span class="o">&amp;</span> <span class="mo">010100110101</span>
             <span class="o">---------------</span>
               <span class="mo">000000000001</span>

<span class="n">mask</span><span class="o">&lt;&lt;=</span><span class="mi">1</span>       <span class="mo">000000000010</span>
<span class="n">header</span>       <span class="o">&amp;</span> <span class="mo">010100110101</span>
              <span class="o">---------------</span>
               <span class="mo">000000000000</span>
</code></pre></div>
<p>Afterwords we want to remove the least significant bit from the pixel:</p>
<div class="highlight"><pre><code class="language-C++" data-lang="C++"><span class="o">~</span><span class="n">mask</span>          <span class="mi">111111111110</span>
<span class="n">pixels</span>       <span class="o">&amp;</span> <span class="mi">101010111001</span>
             <span class="o">---------------</span>
               <span class="mi">101010111000</span>
</code></pre></div>
<p>Then we fuse the two together with bitwise OR (<code>|</code>):</p>
<div class="highlight"><pre><code class="language-C++" data-lang="C++"><span class="p">(</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">header</span><span class="p">)</span>         <span class="mo">000000000001</span>
<span class="p">(</span><span class="o">~</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">pixel</span><span class="p">)</span>       <span class="o">|</span> <span class="mi">101010111000</span>
                      <span class="o">---------------</span>
                        <span class="mi">101010111001</span>
</code></pre></div>
<div class="message">Keep in mind that the binary in the examples above is actually much longer.</div>

<p>The same thing in C++ &amp; Qt:</p>
<div class="highlight"><pre><code class="language-C++" data-lang="C++">        <span class="n">QRgb</span> <span class="n">bit</span>   <span class="o">=</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">(</span><span class="n">header</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">);</span>
        <span class="n">QRgb</span> <span class="n">pixel</span> <span class="o">=</span> <span class="n">encodedImage</span><span class="o">-&gt;</span><span class="n">pixel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mh">0x0001</span><span class="p">;</span>

        <span class="n">encodedImage</span><span class="o">-&gt;</span><span class="n">setPixel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">pixel</span> <span class="o">|</span> <span class="n">bit</span><span class="p">);</span>
</code></pre></div>
<p>Finally to keep iterating through the image left to right and top to bottom, we write this at the end of the loop:</p>
<div class="highlight"><pre><code class="language-C++" data-lang="C++">        <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="n">x</span> <span class="o">==</span> <span class="n">image</span><span class="p">.</span><span class="n">width</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="n">y</span> <span class="o">==</span> <span class="n">image</span><span class="p">.</span><span class="n">height</span><span class="p">())</span> <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div>
<p>The encoding process is mostly the same for the actual message, except now there is an outer loop that iterates through each character of the message, then an inner loop which encodes the character into 16 pixels of the image. Because the header was an <code>int</code> it took up 32 bits and used 32 pixels. To make sure each character only uses 16 pixels, <code>mask</code> is changed from <code>int</code> to <code>ushort</code>, a variable that only takes up 16 bits of space. Because a <code>ushort</code> is only 16 bits long, and <code>mask</code> is shifted one bit every iteration, the inner loop will run out after 16 iterations, encoding 16 pixels.</p>

<h2>The final code:</h2>
<div class="highlight"><pre><code class="language-C++" data-lang="C++"><span class="n">QImage</span><span class="o">*</span> <span class="n">Cipher</span><span class="o">::</span><span class="n">encodeImage</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">QImage</span><span class="o">*</span> <span class="n">encodedImage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QImage</span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">image</span><span class="p">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">image</span><span class="p">.</span><span class="n">height</span><span class="p">()));</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">message</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">message</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="o">||</span> <span class="n">bitsPerPixel</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">encodedImage</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">mask</span> <span class="o">=</span> <span class="mh">0x0001</span><span class="p">;</span> <span class="n">mask</span> <span class="o">!=</span> <span class="mh">0x0000</span><span class="p">;</span> <span class="n">mask</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">QRgb</span> <span class="n">bit</span>   <span class="o">=</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">(</span><span class="n">header</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">);</span>
        <span class="n">QRgb</span> <span class="n">pixel</span> <span class="o">=</span> <span class="n">encodedImage</span><span class="o">-&gt;</span><span class="n">pixel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mh">0x0001</span><span class="p">;</span>

        <span class="n">encodedImage</span><span class="o">-&gt;</span><span class="n">setPixel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">pixel</span> <span class="o">|</span> <span class="n">bit</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="n">x</span> <span class="o">==</span> <span class="n">image</span><span class="p">.</span><span class="n">width</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="n">y</span> <span class="o">==</span> <span class="n">image</span><span class="p">.</span><span class="n">height</span><span class="p">())</span> <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">QChar</span><span class="o">*</span> <span class="n">character</span> <span class="o">=</span> <span class="n">message</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">character</span> <span class="o">!=</span> <span class="n">message</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">character</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">ushort</span> <span class="n">mask</span> <span class="o">=</span> <span class="mh">0x0001</span><span class="p">;</span> <span class="n">mask</span> <span class="o">!=</span> <span class="mh">0x0000</span><span class="p">;</span> <span class="n">mask</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">QRgb</span> <span class="n">bit</span>   <span class="o">=</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span>  <span class="p">(</span><span class="n">character</span><span class="o">-&gt;</span><span class="n">unicode</span><span class="p">()</span> <span class="o">&amp;</span>  <span class="n">mask</span><span class="p">);</span>
            <span class="n">QRgb</span> <span class="n">pixel</span> <span class="o">=</span> <span class="n">encodedImage</span><span class="o">-&gt;</span><span class="n">pixel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mh">0x0001</span><span class="p">;</span>

            <span class="n">encodedImage</span><span class="o">-&gt;</span><span class="n">setPixel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">pixel</span> <span class="o">|</span> <span class="n">bit</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="n">x</span> <span class="o">==</span> <span class="n">image</span><span class="p">.</span><span class="n">width</span><span class="p">())</span> <span class="p">{</span>
                <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="n">y</span> <span class="o">==</span> <span class="n">image</span><span class="p">.</span><span class="n">height</span><span class="p">())</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="n">encodedImage</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">encodedImage</span><span class="p">;</span>
</code></pre></div>
<h1>This is so Meta</h1>

<p>To come full circle, here is Andy again, except this time this <strong>entire</strong> post is encoded into him:</p>

<div><img src="/media/2014-08-04-stickshifts-n-safetybelts/andy-encoded-alot.png" alt="This image contains the <b>entire</b> post." />
<blockquote style="border-left: 10px solid #D5D5D5;">This image contains the <b>entire</b> post.</blockquote></div>

<p>&mdash; Michael</p>


	<br/><br/>
	<h2>Say It Loud! Leave a comment below:</h2>
	<div class="fb-comments" data-href="https://illegalprime.github.io//blog/bitshifts-n-safetybelts" data-width="100%" data-numposts="10" data-colorscheme="light"></div>
</div>


<footer class="clean" style="background-image: url(/media/2014-08-07-wireless-sharing/cover.png);height: 75%; min-height: 500px;">
	<div id="nav-icon" style="top: 25px;">
		<a class="scroll" data-speed="1000" href="#article"><span class="genericon genericon-collapse"></span></a>
	</div>
	<div id="post-info">
		<h3>Featured post</h3>
		<a href="/blog/wireless-sharing">
			<h1>WiFi Sharing in Linux with two wireless cards</h1>
			
		</a>
	</div>
	<p class="copyright">&copy;2014, <a href="http://camporez.com" target="_blank">Camporez</a>. <a href="http://creativecommons.org/licenses/by-nc/2.5" target="_blank">Some rights reserved</a>.</p>
</footer>

<script src="/assets/js/smooth-scroll.js"></script>

</body>
</html>